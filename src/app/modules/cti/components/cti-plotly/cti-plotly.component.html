<div class="cti-plotly-container">
  <div class="header-container">
    <h1>Cyber Threat Intelligence Dashboard</h1>
    <button mat-raised-button color="primary" (click)="navigateToDashboard()">
      <mat-icon>arrow_back</mat-icon>
      Back to Dashboard
    </button>
  </div>

  <div class="loading-overlay" *ngIf="isLoading">
    <mat-spinner></mat-spinner>
    <p>Loading dashboard...</p>
  </div>

  <div class="debug-info">
    <p>Component loaded successfully!</p>
    <p>If you can see this message, the component is working.</p>
    <p>Click the button above to go back to the main dashboard.</p>
  </div>

  <mat-tab-group>
    <mat-tab label="Threat Overview">
      <div class="tab-content">
        <div class="grid-container">
          <!-- First row -->
          <div class="grid-item grid-item-large">
            <app-threat-map></app-threat-map>
          </div>
          <div class="grid-item grid-item-large">
            <app-threat-evolution></app-threat-evolution>
          </div>

          <!-- Second row -->
          <div class="grid-item grid-item-large">
            <app-mitre-heatmap></app-mitre-heatmap>
          </div>
          <div class="grid-item grid-item-large">
            <div class="chart-container">
              <div class="chart-header">
                <h3>Event Timeline</h3>
                <div class="chart-actions">
                  <button mat-icon-button matTooltip="Refresh">
                    <mat-icon>refresh</mat-icon>
                  </button>
                  <button mat-icon-button matTooltip="Fullscreen">
                    <mat-icon>fullscreen</mat-icon>
                  </button>
                </div>
              </div>
              <div class="chart-content">
                <div #eventTimelineContainer class="plotly-chart"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </mat-tab>

    <mat-tab label="Network Analysis">
      <div class="tab-content">
        <div class="grid-container">
          <!-- First row -->
          <div class="grid-item grid-item-large">
            <div class="chart-container">
              <div class="chart-header">
                <h3>Community Detection</h3>
                <div class="chart-actions">
                  <button mat-icon-button matTooltip="Refresh">
                    <mat-icon>refresh</mat-icon>
                  </button>
                  <button mat-icon-button matTooltip="Fullscreen">
                    <mat-icon>fullscreen</mat-icon>
                  </button>
                </div>
              </div>
              <div class="chart-content">
                <div #communityDetectionContainer class="plotly-chart"></div>
              </div>
            </div>
          </div>
          <div class="grid-item grid-item-large">
            <div class="chart-container">
              <div class="chart-header">
                <h3>PageRank / Betweenness Centrality</h3>
                <div class="chart-actions">
                  <button mat-icon-button matTooltip="Refresh">
                    <mat-icon>refresh</mat-icon>
                  </button>
                  <button mat-icon-button matTooltip="Fullscreen">
                    <mat-icon>fullscreen</mat-icon>
                  </button>
                </div>
              </div>
              <div class="chart-content">
                <div #pageRankContainer class="plotly-chart"></div>
              </div>
            </div>
          </div>

          <!-- Second row -->
          <div class="grid-item grid-item-large">
            <div class="chart-container">
              <div class="chart-header">
                <h3>Node Similarity</h3>
                <div class="chart-actions">
                  <button mat-icon-button matTooltip="Refresh">
                    <mat-icon>refresh</mat-icon>
                  </button>
                  <button mat-icon-button matTooltip="Fullscreen">
                    <mat-icon>fullscreen</mat-icon>
                  </button>
                </div>
              </div>
              <div class="chart-content">
                <div #nodeSimilarityContainer class="plotly-chart"></div>
              </div>
            </div>
          </div>
          <div class="grid-item grid-item-large">
            <div class="chart-container">
              <div class="chart-header">
                <h3>Emerging Threats</h3>
                <div class="chart-actions">
                  <button mat-icon-button matTooltip="Refresh">
                    <mat-icon>refresh</mat-icon>
                  </button>
                  <button mat-icon-button matTooltip="Fullscreen">
                    <mat-icon>fullscreen</mat-icon>
                  </button>
                </div>
              </div>
              <div class="chart-content">
                <div #emergingThreatsContainer class="plotly-chart"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </mat-tab>

    <mat-tab label="OSINT Analysis">
      <div class="tab-content">
        <div class="grid-container">
          <!-- First row -->
          <div class="grid-item grid-item-large">
            <div class="chart-container">
              <div class="chart-header">
                <h3>OSINT Treemap</h3>
                <div class="chart-actions">
                  <button mat-icon-button matTooltip="Refresh">
                    <mat-icon>refresh</mat-icon>
                  </button>
                  <button mat-icon-button matTooltip="Fullscreen">
                    <mat-icon>fullscreen</mat-icon>
                  </button>
                </div>
              </div>
              <div class="chart-content">
                <div #osintTreemapContainer class="plotly-chart"></div>
              </div>
            </div>
          </div>
          <div class="grid-item grid-item-large">
            <div class="chart-container">
              <div class="chart-header">
                <h3>Anomalies in IOC</h3>
                <div class="chart-actions">
                  <button mat-icon-button matTooltip="Refresh">
                    <mat-icon>refresh</mat-icon>
                  </button>
                  <button mat-icon-button matTooltip="Fullscreen">
                    <mat-icon>fullscreen</mat-icon>
                  </button>
                </div>
              </div>
              <div class="chart-content">
                <div #anomaliesContainer class="plotly-chart"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>
